\addcontentsline{toc}{chapter}{Занятие 6. Формула полной вероятности. Формула Байеса}
\chapter*{Занятие 6. Формула полной вероятности. Формула Байеса}

\addcontentsline{toc}{section}{Контрольные вопросы и задания}
\section*{Контрольные вопросы и задания}

\subsubsection*{Приведите определение полной группы гипотез.}

Набор случайных событий $H_1, \dotsc, H_n$ называется полным набором гипотез, если выполнены следующие условия:
\begin{enumerate}
\item $P \left( H_i \right) > 0, \, i = \overline{1, n} $;
\item $H_i \cap H_j = \varnothing, \, i \neq j$ (они несовместны);
\item $ \bigcup \limits_{i=1}^n H_i = \Omega $.
\end{enumerate}

\subsubsection*{Запишите формулу для вычисления условной вероятности, формулу полной вероятности, формулу Байеса.}

Условная вероятность события $A$ при условии, что событие $B$ произошло --- это выражение
$$P \left( \left. A \right| B \right) =
\frac{P \left( A \cap B \right) }{P \left( B \right) }.$$

Формула полной вероятности: $P \left( A \right) = \sum \limits_{i=1}^n P \left( \left. A \right| H_i \right) P \left( H_i \right) $.

Формула Байеса:
$$P \left( \left. H_i \right| A \right) =
\frac{P \left( \left. A \right| H_i \right) P \left( H_i \right) }{ \sum \limits_{k=1}^n P \left( \left. A \right| H_k \right) P \left( H_k \right) }.$$

\subsubsection*{Когда применяется формула полной вероятности, формула Байеса?}

В формуле полной вероятности содержатся априорные вероятности. Формула Байеса переоценивает вероятности гипотез --- апостериорные вероятности.

\addcontentsline{toc}{section}{Аудиторные задачи}
\section*{Аудиторные задачи}

\subsubsection*{6.3}

\textit{Задание.} В первой урне находятся 1 белый и 4 красных шара, а во второй урне --- 2 белых и 7 красных шаров.
Из второй урны наугад вынули 1 шар и переложили её в первую урну.
После этого из первой урны наугад вынули 1 шар.
Найдите вероятность того, что этот шар окажется красным.

\textit{Решение.}
Введём событие $A =$ \{шар, вынутый из первой урны после перекладывания одного шара из другой урны, окажется красным\} и сделаем гипотезы о том,
какого цвета шар переложили: $H_1 =$ \{из второй урны переложили в первую белый шар\}, $H_2 =$ \{из второй урны переложили в первую красный шар\}.

Проверяем, что это полная группа гипотез:
$$P \left( H_1 \right) =
\frac{2}{9} >
0, \,
P \left( H_2 \right) =
\frac{7}{9} >
0.$$
События не могут произойти одновременно.
$P \left( H_1 \right) + P \left( H_2 \right) =
1$.
Поэтому имеем полную группу гипотез.

Найдём условные вероятности:
$$P \left( \left. A \right| H_1 \right) =
\frac{4}{6}, \,
P \left( \left. A \right| H_2 \right) =
\frac{5}{6}.$$

Значит по формуле полной вероятности:
\begin{equation*}
\begin{split}
P \left( A \right) =
P \left( H_1 \right) P \left( \left. A \right| H_1 \right) + P \left( H_2 \right) P \left( \left. A \right| H_2 \right) =
\frac{2}{9} \cdot \frac{4}{6} + \frac{7}{9} \cdot \frac{5}{6} = \\
= \frac{2}{9} \cdot \frac{2}{3} + \frac{7}{9} \cdot \frac{5}{6} =
\frac{4}{27} + \frac{35}{54} =
\frac{8+35}{54} =
\frac{43}{54}.
\end{split}
\end{equation*}

\subsubsection*{6.4}

\textit{Задание.} Из урны, которая содержит 3 чёрных и 2 белых шара, наугад вынуты два шара и переложены в другую урну, которая содержит 4 чёрных и 4 белых шара.
Найдите вероятность того, что:
\begin{enumerate}[label=\alph*)]
\item шар, вынутый после этого наугад из второй урны, окажется белым;
\item из первой урны переложили в другую два чёрных шара, при условии, что шар, вынутый после этого из второй урны, оказался белым.
\end{enumerate}

\textit{Решение.} В первой урне содержится 3 чёрных и 2 белых шара, во второй --- 4 чёрных и 4 белых.
\begin{enumerate}[label=\alph*)]
\item Введём событие $A =$ \{вынутый из второй урны после переложения шар окажется белым\}.

Есть 3 разные гипотезы: $H_1 =$ \{переложили 2 белых шара\}, $H_2 = \\ =$ \{переложили 2 чёрных шара\}, $H_3 =$ \{переложили 1 белый и 1 чёрный шар\}.

Находим вероятности этих гипотез:
\begin{equation*}
\begin{split}
P \left( H_1 \right) =
\frac{C_2^2}{C_5^2} =
\frac{2! \cdot 3!}{5!} = 
\frac{2 \cdot 2 \cdot 3}{2 \cdot 3 \cdot 4} =
\frac{1}{2 \cdot 5} =
\frac{1}{10} >
0; \\
P \left( H_2 \right) =
\frac{C_3^2}{C_5^2} =
\frac{3!}{2!} \cdot \frac{2! \cdot 3!}{5!} =
\frac{3}{10} >
0; \\
P \left( H_3 \right) =
\frac{C_3^1 \cdot C_2^1}{C_5^2} =
\frac{3 \cdot 2 \cdot 2 \cdot 2 \cdot 3}{2 \cdot 3 \cdot 4 \cdot 5} =
\frac{3}{5} >
0.
\end{split}
\end{equation*}

В сумме вероятности гипотез дают единицу.
Гипотезы не могут одновременно происходит, поэтому они являются полным набором гипотез.

Найдём условные вероятности:
$$P \left( \left. A \right| H_1 \right) =
\frac{6}{10}, \,
P \left( \left. A \right| H_2 \right) =
\frac{4}{10}, \,
P \left( \left. A \right| H_3 \right) =
\frac{1}{2}.$$

По формуле полной вероятности:
\begin{equation*}
\begin{split}
P \left( A \right) =
\frac{1}{10} \cdot \frac{6}{10} + \frac{2}{10} \cdot \frac{4}{10} + \frac{3}{5} \cdot \frac{1}{2} =
\frac{1}{10} \cdot \frac{3}{5} + \frac{3}{10} \cdot \frac{2}{5} + \frac{3}{5} \cdot \frac{1}{2} = \\
= \frac{3}{50} + \frac{6}{50} + \frac{3}{10} =
\frac{3+6+15}{50} =
\frac{24}{50} =
\frac{12}{25};
\end{split}
\end{equation*}

\item $A$ стало условием.
Знаем, что это событие произошло.
По формуле Байеса:
\begin{equation*}
\begin{split}
P \left( \left. H_2 \right| A \right) =
\frac{P \left( H_2 \right) P \left( \left. A \right| H_2 \right) }{P \left( H_1 \right) P \left( \left. A \right| H_1 \right) +
P \left( H_2 \right) P \left( \left. A \right| H_2 \right) + P \left( H_3 \right) P \left( \left. A \right| H_3 \right) } = \\
= \frac{P \left( H_2 \right) P \left( \left. A \right| H_2 \right) }{P \left( A \right) } =
\frac{3}{10} \cdot \frac{4}{10} \cdot \frac{25}{12} =
\frac{1}{4}.
\end{split}
\end{equation*}
\end{enumerate}

\addcontentsline{toc}{section}{Домашнее задание}
\section*{Домашнее задание}

\subsubsection*{6.13}

\textit{Задание.} В первой урне содержатся 1 белый и 9 чёрных шаров; во второй урне --- 1 чёрный и 5 белых шаров.
Из каждой урны наугад вынуто по одному шару, а остальные пересыпали в третью урну.
Найдите вероятность того, что шар, вынутый наугад из третьей урны, окажется белым.

\textit{Решение.}
Введём полную группу событий:
$H_1 =$ \{из обеих урн вынули по одному белому шару\};
$H_2 =$ \{из первой урны достали 1 белый шар и из второй --- 1 чёрный шар\};
$H_3 =$ \{из обеих урн вынули по одному чёрному шару\};
$H_4 =$ \{из первой урны достали 1 чёрный шар и из второй урны --- 1 белый шар\};
Определим вероятности этих событий:
\begin{equation*}
\begin{split}
P \left\{ H_1 \right\} =
\frac{1}{10} \cdot \frac{5}{6} =
\frac{1}{12}, \,
P \left\{ H_2 \right\} =
\frac{1}{10} \cdot \frac{1}{6} =
\frac{1}{60} \,
P \left\{ H_3 \right\} =
\frac{9}{10} \cdot \frac{1}{6} =
\frac{3}{10 \cdot 2} =
\frac{3}{20}, \\
P \left\{ H_4 \right\} =
\frac{9}{10} \cdot \frac{5}{6} =
\frac{3}{4}.
\end{split}
\end{equation*}
Введём событие $A =$ \{из третьей урны вытянули белый шар\}.
В то же время
$$P \left\{ \left. A \right| H_1 \right\} =
\frac{4}{14} =
\frac{2}{7}, \,
P \left\{ \left. A \right| H_2 \right\} =
\frac{5}{14} =
P \left\{ \left. A \right| H_4 \right\}, \,
P \left\{ \left. A \right| H_3 \right\} =
\frac{6}{14} =
\frac{3}{7}.$$
Согласно с формулой полной вероятности $P \left\{ A \right\} = \sum \limits_{i=1}^\infty P \left\{ H_i \right\} \cdot P \left\{ \left. A \right| H_i \right\} $ имеем
\begin{equation*}
\begin{split}
P \left\{ A \right\} =
\frac{1}{12} \cdot \frac{2}{7} + \frac{1}{60} \cdot \frac{5}{14} + \frac{3}{20} \cdot \frac{3}{7} + \frac{3}{4} \cdot \frac{5}{14} =
\frac{38}{105}.
\end{split}
\end{equation*}

\subsubsection*{6.14}

\textit{Задание.} Два стрелка стреляют по мишени.
Один из них попадает в 5 случаях, а другой --- в 8 случаях из 10.
Перед выстрелом они подбрасывают правильную монету для определения очередности.
Сторонний наблюдатель знает условия стрельбы, но не видит, кто в данный момент стреляет.
Он видит, что стрелок попал по мишени.
Найдите вероятность того, что стрелял первый стрелок.

\textit{Решение.} Первый стрелок попадает по мишени с вероятностью
$$P \left( \left. A \right| H_1 \right) =
\frac{5}{10} =
\frac{1}{2},$$
второй стрелок --- с вероятностью
$$P \left( \left. A \right| H_2 \right) =
\frac{8}{10} =
\frac{4}{5}.$$
Априорные вероятности этих гипотез одинаковы:
$$P \left( H_1 \right) =
P \left( H_2 \right) =
\frac{1}{2}.$$
Рассмотрим событие $A =$ \{стрелок попал в цель\}.
Поэтому вероятность стрелять первому стрелку
\begin{equation*}
\begin{split}
P \left( \left. A \right| H_1 \right) =
\frac{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) }{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. A \right| H_2 \right) P \left( H_2 \right) } =
\frac{ \frac{1}{2} \cdot \frac{1}{2} }{ \frac{1}{2} \cdot \frac{1}{2} + \frac{4}{5} \cdot \frac{1}{2} } =
\frac{ \frac{1}{4} }{ \frac{1}{4} + \frac{2}{5} } = \\
= \frac{ \frac{1}{4} }{ \frac{5+8}{20} } =
\frac{20}{4 \cdot 13} =
\frac{5}{13}.
\end{split}
\end{equation*}

\subsubsection*{6.15}

\textit{Задание.} Среди $N$ экзаменационных билетов есть $n$ <<счастливых>>.
Студенты подходят за билетами по одному.
У кого больше шансов вынуть счастливый билет: у того, кто подошёл первым, или у того, что подошёл вторым?
Найдите вероятность того, что студент, который подошёл первым, вынул счастливый билет, если известно, что студент, который подошёл вторым, вынул счастливый билет.

\textit{Решение.} Если студент сдаёт экзамен первым, то вероятность вынуть счастливый билет равна $n/N$.
Рассмотрим ситуацию, когда он сдаёт вторым.
Введём гипотезы: $H_1$ --- первый забрал <<счастливый>> билет, $H_2$ --- первый не забрал <<счастливый>> билет.
Событие $A =$ \{студент сдал экзамен\}.
\begin{equation*}
\begin{split}
P \left( \left. A \right| H_1 \right) =
\frac{n-1}{N-1}, \,
P \left( \left. A \right| H_2 \right) =
\frac{n}{N-1}, \,
P \left( H_1 \right) =
\frac{n}{N}, \,
P \left( H_2 \right) =
1 - \frac{n}{N} = \\
= \frac{N-n}{N}.
\end{split}
\end{equation*}
Используем формулу полной вероятности:
\begin{equation*}
\begin{split}
P \left( A \right) =
\frac{n-1}{N-1} \cdot \frac{n}{N} + \frac{n}{N-1} \cdot \frac{N-n}{N} =
\frac{n}{N \left( N-1 \right) } \cdot \left( n-1+N-n \right) = \\
= \frac{n \left( N-1 \right) }{N \left( N-1 \right) } =
\frac{n}{N}.
\end{split}
\end{equation*}
Вывод: без разницы, когда сдавать.

Вероятность того, что студент, который пошёл первым, вынул счастливый билет, если известно, что студент, который пошёл вторым, вынул счастливый билет:
\begin{equation*}
\begin{split}
P \left( \left. H_1 \right| A \right) =
\frac{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) }{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. A \right| H_2 \right) P \left( H_2 \right) } = \\
= \frac{ \frac{n-1}{N-1} \cdot \frac{n}{N} }{ \frac{n-1}{N-1} \cdot \frac{n}{N} + \frac{n}{N-1} \cdot \frac{N-n}{N} } =
\frac{ \frac{n-1}{N-1} \cdot \frac{n}{N} }{ \frac{n}{N \left( N-1 \right) } \cdot \left( n-1+N-n \right) } =
\frac{n-1}{N-1}.
\end{split}
\end{equation*}

\subsubsection*{6.16}

\textit{Задание.} На вход радиолокационного устройства с вероятностью $0.4$ попадает сигнал с шумом и с вероятностью $0.6$ --- только шум.
Если попадает сигнал с шумом, то устройство регистрирует наличие сигнала с вероятностью $0.7$, а если попадает только шум,
то устройство регистрирует наличие сигнала с вероятностью $0.5$.
Известно, что устройство зарегистрировало шум.
Найдите вероятность того, что сигнал действительно попал на вход радиолокационного устройства.

\textit{Решение.}
Введём событие $A =$ \{устройство зарегистрировало наличие сигнала\} и сделаем гипотезы о том,
какой же сигнал попал на радиолокационное устройство: $H_1 =$ \{попал сигнал с шумом\}, $H_2 =$ \{попал только шум\}.
Нам нужно найти условную вероятность $P \left( \left. H_1 \right| A \right) $.
По формуле Байеса:
\begin{equation*}
\begin{split}
P \left( \left. H_1 \right| A \right) =
\frac{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) }{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. A \right| H_2 \right) P \left( H_2 \right) } =
\frac{0.7 \cdot 0.4}{0.7 \cdot 0.4 + 0.5 \cdot 0.6} = \\
= \frac{7 \cdot 4}{7 \cdot 4 + 5 \cdot 6} =
\frac{7 \cdot 2}{7 \cdot 2 + 5 \cdot 3} =
\frac{14}{14 + 15} =
\frac{14}{29}.
\end{split}
\end{equation*}

\subsubsection*{6.17}

\textit{Задание.} В Лондоне в половину дней года идёт дождь.
Прогноз погоды сбывается в $2/3$ случаев,
то есть условная вероятность того,
что будет идти дождь, при условии, что его прогнозировали, и условная вероятность того, что дождя не будет, при условии, что его не прогнозировали, равны $2/3$.
Если прогнозируют дождь, мистер Пиквик всегда берёт зонт.
Если же дождь не прогнозируют, то мистер Пиквик берёт зонт с вероятностью $1/3$.
Найдите вероятность того, что:
\begin{enumerate}[label=\alph*)]
\item мистер Пиквик не имеет зонта, при условии, что идёт дождь;
\item дождя нет, при условии, что мистер Пиквик имеет зонт.
\end{enumerate}

\textit{Решение.}
Выберем событие $A =$ \{мистер Пиквик берёт зонт\} и сделаем гипотезы о том,
будет или нет дождь, прогнозировали его или нет: $H_1 = \\ =$ \{дождь прогнозировали\}, $H_2 =$ \{дождь не прогнозировали\}, $X_1 =$ \{идёт дождь\}, $X_2 =$ \{дождь не идёт\}.
Есть такие условия:
\begin{equation*}
\begin{split}
P \left( X_1 \right) =
P \left( X_2 \right) =
\frac{1}{2}, \,
P \left( \left. X_1 \right| H_1 \right) =
\frac{2}{3} \rightarrow
P \left( \left. X_1 \right| H_1 \right) =
1 - \frac{2}{3} =
\frac{1}{3}, \\
P \left( \left. X_2 \right| H_2 \right) =
\frac{2}{3} \rightarrow
P \left( \left. X_2 \right| H_2 \right) =
1 - \frac{2}{3} =
\frac{1}{3}, \,
P \left( \left. A \right| H_1 \right) =
1, \,
P \left( \left. A \right| H_2 \right) =
\frac{1}{3}.
\end{split}
\end{equation*}
\begin{enumerate}[label=\alph*)]
\item Нужно найти условную вероятность $P \left( \left. \overline{A} \right| X_1 \right) $.
Найдём сначала вероятность того, что идёт дождь.
По формуле полной вероятности:
$P \left( X_1 \right) =
P \left( \left. X_1 \right| H_1 \right) P \left( H_1 \right) + P \left( \left. X_1 \right| H_2 \right) P \left( H_2 \right) =
P \left( H_1 \right) P \left( \left. X_1 \right| H_1 \right) +  \\
+ \left( 1 - P \left( H_1 \right) \right) P \left( \left. X_2 \right| H_2 \right) =
P \left( H_1 \right) \cdot \frac{2}{3} + \left( 1 - P \left( H_1 \right) \right) \cdot \frac{2}{3} =
\frac{2}{3} \cdot P \left( H_1 \right) + \\
+ \frac{1}{3} - \frac{1}{4} \cdot P \left( H_1 \right) =
\frac{1}{3} \cdot P \left( H_1 \right) + \frac{1}{3} =
\frac{1}{2}$.
Умножим полученное равенство на 6: $2P \left( H_1 \right) + 2 = 3$.
Перенесём двойку в правую сторону: $2P \left( H_1 \right) = 3 - 2 = 1$.
Выразим вероятность:
$$P \left( H_1 \right) =
\frac{1}{2}.$$
Требуемая условная вероятность равна
\begin{equation*}
\begin{split}
P \left( \left. \overline{A} \right| X_1 \right) =
\frac{P \left( \left. \overline{A} \cap X_1 \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. \overline{A} \cap X_1 \right| H_2 \right) P \left( H_2 \right) }{P \left( X_1 \right) } = \\
= 2 \cdot \frac{1}{2} \left( P \left( \left. \overline{A} \right| H_1 \right) P \left( \left. X_1 \right| H_1 \right) +
P \left( \left. \overline{A} \right| H_2 \right) P \left( \left. X_1 \right| H_2 \right) \right) = \\
= \left( 1-1 \right) \cdot \frac{2}{3} + \left( 1 - \frac{1}{3} \right) \cdot \frac{1}{3} =
0 \cdot \frac{2}{3} + \frac{2}{3} \cdot \frac{1}{3} =
\frac{2}{9};
\end{split}
\end{equation*}
\item 
\begin{equation*}
\begin{split}
P \left( \left. X_2 \right| A \right) =
\frac{P \left( X_2 \cap A \right) }{P \left( A \right) } = \\
= \frac{P \left( \left. X_2 \cap A \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. X_2 \cap A \right| H_2 \right) P \left( H_2 \right) }{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. A \right| H_2 \right) P \left( H_2 \right) } = \\
= \frac{P \left( \left. X_2 \right| H_1 \right) P \left( \left. A \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. X_2 \right| H_2 \right) P \left( \left. A \right| H_2 \right) P \left( H_2 \right)}{P \left( \left. A \right| H_1 \right) P \left( H_1 \right) +
P \left( \left. A \right| H_2 \right) P \left( H_2 \right) } = \\
= \frac{ \frac{1}{3} \cdot 1 \cdot \frac{1}{2} + \frac{2}{3} \cdot \frac{1}{3} \left( 1 - \frac{1}{2} \right) }{1 \cdot \frac{1}{2} +
\frac{1}{3} \left( 1 - \frac{1}{2} \right) } =
\frac{ \frac{1}{6} + \frac{2}{9} \cdot \frac{1}{2} }{ \frac{1}{2} + \frac{1}{3} \cdot \frac{1}{2} } =
\frac{ \frac{1}{6} + \frac{1}{9} }{ \frac{1}{2} + \frac{1}{6} } =
\frac{ \frac{3+2}{18} }{ \frac{3+1}{6} } = \\
= \frac{5}{18} \cdot \frac{6}{4} =
\frac{5}{34} =
\frac{5}{12}.
\end{split}
\end{equation*}
\end{enumerate}
